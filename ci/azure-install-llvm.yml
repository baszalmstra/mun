# defaults for any parameters that aren't specified
parameters:
  llvm_version: 7
  llvm_version_windows: 7.0.1

steps:
  # Linux
  - script: |
      set -e
      sudo apt install llvm-$LLVM_VERSION llvm-$LLVM_VERSION-* lld-$LLVM_VERSION
    env:
      LLVM_VERSION: ${{parameters.llvm_version}}
    displayName: "Install LLVM (*nix)"
    condition: eq(variables['Agent.OS'], 'Linux')

  # Darwin
  - script: |
      set -e
      brew install llvm@$LLVM_VERSION
    env:
      LLVM_VERSION: ${{parameters.llvm_version}}
    displayName: "Install LLVM (macOS)"
    condition: eq(variables['Agent.OS'], 'Darwin')
    
  # Windows.
  - script: |
      choco install llvm --version=%LLVM_VERSION%
    env:
      LLVM_VERSION: ${{parameters.llvm_version_windows}}
    displayName: "Install LLVM (windows)"
    condition: eq(variables['Agent.OS'], 'Windows_NT')